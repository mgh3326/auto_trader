<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 800"><rect width="1200" height="800" fill="#0f172a"/><text x="600" y="50" fill="#fff" font-family="Apple SD Gothic Neo, Arial, sans-serif" font-size="32" font-weight="bold" text-anchor="middle">Docker 멀티스테이지 빌드 최적화</text><text x="600" y="85" fill="#94a3b8" font-family="Apple SD Gothic Neo, Arial, sans-serif" font-size="18" text-anchor="middle">Poetry → UV: 빌드 시간 81% 단축 (3분 → 35초)</text><g transform="translate(100, 130)"><rect width="480" height="60" fill="#dc2626" rx="10"/><text x="240" y="40" fill="#fff" font-family="Apple SD Gothic Neo, Arial, sans-serif" font-size="20" font-weight="bold" text-anchor="middle">Poetry: Stage 1 (builder)</text><rect width="480" height="280" y="70" fill="#1e293b" rx="8"/><text x="20" y="100" fill="#fbbf24" font-family="Apple SD Gothic Neo, Courier, monospace" font-size="13">FROM python:3.11-slim AS builder</text><text x="20" y="125" fill="#94a3b8" font-family="Apple SD Gothic Neo, Arial, sans-serif" font-size="13"># Poetry 설치 (Python 패키지)</text><text x="20" y="150" fill="#cbd5e1" font-family="Apple SD Gothic Neo, Courier, monospace" font-size="13">RUN pip install poetry</text><text x="20" y="180" fill="#94a3b8" font-family="Apple SD Gothic Neo, Arial, sans-serif" font-size="13"># lockfile 복사</text><text x="20" y="205" fill="#cbd5e1" font-family="Apple SD Gothic Neo, Courier, monospace" font-size="13">COPY pyproject.toml poetry.lock ./</text><text x="20" y="235" fill="#94a3b8" font-family="Apple SD Gothic Neo, Arial, sans-serif" font-size="13"># 의존성 설치 (느림)</text><text x="20" y="260" fill="#cbd5e1" font-family="Apple SD Gothic Neo, Courier, monospace" font-size="13">RUN poetry config virtualenvs.create false</text><text x="20" y="285" fill="#cbd5e1" font-family="Apple SD Gothic Neo, Courier, monospace" font-size="13">RUN poetry install --only main</text><text x="240" y="330" fill="#fca5a5" font-family="Apple SD Gothic Neo, Arial, sans-serif" font-size="16" font-weight="bold" text-anchor="middle">⏱️ 약 2분 30초</text></g><g transform="translate(100, 450)"><rect width="480" height="60" fill="#dc2626" rx="10"/><text x="240" y="40" fill="#fff" font-family="Apple SD Gothic Neo, Arial, sans-serif" font-size="20" font-weight="bold" text-anchor="middle">Poetry: Stage 2 (final)</text><rect width="480" height="200" y="70" fill="#1e293b" rx="8"/><text x="20" y="100" fill="#fbbf24" font-family="Apple SD Gothic Neo, Courier, monospace" font-size="13">FROM python:3.11-slim AS final</text><text x="20" y="130" fill="#94a3b8" font-family="Apple SD Gothic Neo, Arial, sans-serif" font-size="13"># Python 패키지 복사 (전역 설치)</text><text x="20" y="155" fill="#cbd5e1" font-family="Apple SD Gothic Neo, Courier, monospace" font-size="13">COPY --from=builder /usr/local/lib ...</text><text x="20" y="185" fill="#94a3b8" font-family="Apple SD Gothic Neo, Arial, sans-serif" font-size="13"># 앱 코드 복사</text><text x="20" y="210" fill="#cbd5e1" font-family="Apple SD Gothic Neo, Courier, monospace" font-size="13">COPY . .</text><text x="20" y="235" fill="#cbd5e1" font-family="Apple SD Gothic Neo, Courier, monospace" font-size="13">CMD [&quot;uvicorn&quot;, &quot;app.main:app&quot;]</text></g><g transform="translate(620, 130)"><rect width="480" height="60" fill="#10b981" rx="10"/><text x="240" y="40" fill="#fff" font-family="Apple SD Gothic Neo, Arial, sans-serif" font-size="20" font-weight="bold" text-anchor="middle">UV: Stage 1 (builder)</text><rect width="480" height="280" y="70" fill="#1e293b" rx="8"/><text x="20" y="100" fill="#10b981" font-family="Apple SD Gothic Neo, Courier, monospace" font-size="13">FROM python:3.12-slim AS builder</text><text x="20" y="125" fill="#94a3b8" font-family="Apple SD Gothic Neo, Arial, sans-serif" font-size="13"># UV 설치 (Rust 바이너리)</text><text x="20" y="150" fill="#d1fae5" font-family="Apple SD Gothic Neo, Courier, monospace" font-size="13">RUN pip install uv</text><text x="20" y="180" fill="#94a3b8" font-family="Apple SD Gothic Neo, Arial, sans-serif" font-size="13"># lockfile + README 복사</text><text x="20" y="205" fill="#d1fae5" font-family="Apple SD Gothic Neo, Courier, monospace" font-size="13">COPY pyproject.toml uv.lock README.md ./</text><text x="20" y="235" fill="#94a3b8" font-family="Apple SD Gothic Neo, Arial, sans-serif" font-size="13"># 의존성 설치 (빠름, 캐시 활용)</text><text x="20" y="260" fill="#d1fae5" font-family="Apple SD Gothic Neo, Courier, monospace" font-size="13">RUN --mount=type=cache,target=/root/.cache/uv</text><text x="20" y="285" fill="#d1fae5" font-family="Apple SD Gothic Neo, Courier, monospace" font-size="13">uv sync --frozen</text><text x="240" y="330" fill="#10b981" font-family="Apple SD Gothic Neo, Arial, sans-serif" font-size="16" font-weight="bold" text-anchor="middle">⏱️ 약 20초 (88% 단축)</text></g><g transform="translate(620, 450)"><rect width="480" height="60" fill="#10b981" rx="10"/><text x="240" y="40" fill="#fff" font-family="Apple SD Gothic Neo, Arial, sans-serif" font-size="20" font-weight="bold" text-anchor="middle">UV: Stage 2 (final)</text><rect width="480" height="200" y="70" fill="#1e293b" rx="8"/><text x="20" y="100" fill="#10b981" font-family="Apple SD Gothic Neo, Courier, monospace" font-size="13">FROM python:3.12-slim AS final</text><text x="20" y="130" fill="#94a3b8" font-family="Apple SD Gothic Neo, Arial, sans-serif" font-size="13"># .venv 폴더만 복사 (간결)</text><text x="20" y="155" fill="#d1fae5" font-family="Apple SD Gothic Neo, Courier, monospace" font-size="13">COPY --from=builder /app/.venv ./.venv</text><text x="20" y="185" fill="#94a3b8" font-family="Apple SD Gothic Neo, Arial, sans-serif" font-size="13"># 앱 코드 복사</text><text x="20" y="210" fill="#d1fae5" font-family="Apple SD Gothic Neo, Courier, monospace" font-size="13">COPY . .</text><text x="20" y="235" fill="#d1fae5" font-family="Apple SD Gothic Neo, Courier, monospace" font-size="13">CMD [&quot;.venv/bin/uvicorn&quot;, &quot;app.main:app&quot;]</text></g><rect width="480" height="60" x="100" y="710" fill="#7f1d1d" rx="8"/><text x="340" y="745" fill="#fca5a5" font-family="Apple SD Gothic Neo, Arial, sans-serif" font-size="18" font-weight="bold" text-anchor="middle">Poetry: 전체 약 3분 10초</text><rect width="480" height="60" x="620" y="710" fill="#065f46" rx="8"/><text x="860" y="745" fill="#10b981" font-family="Apple SD Gothic Neo, Arial, sans-serif" font-size="18" font-weight="bold" text-anchor="middle">UV: 전체 약 35초 (81% 단축)</text></svg>